This code has a lot room for improvement...