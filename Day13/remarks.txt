Can it be done without enumerating all the permutations?